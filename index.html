<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Attendance System</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f3f4f6;
      margin: 0;
      padding: 0;
    }

    .header {
      text-align: center;
      background-color: #4f46e5;
      color: white;
      padding: 1rem;
    }

    .header button {
      background-color: white;
      color: #8e87f5;
      border: none;
      padding: 10px;
      font-weight: bold;
      cursor: pointer;
      border-radius: 5px;
      margin-top: 10px;
      transition: background-color 0.5s, color 0.5s;
    }

    .header button:hover {
      background-color: gold;
      color: blue;
    }

    #dis {
      position: sticky;
      top: 10px;
      z-index: 999;
      margin: auto;
      height: auto;
      width: 300px;
      background-color: gold;
      color: #5a0374;
      text-align: left;
      border: 2px solid #000;
      border-radius: 15px;
      padding: 1rem;
      font-size: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      font-family: 'Segoe UI', sans-serif;
      animation: labukzabuk 1s ease-in-out infinite;
      transition: all 0.3s ease;
    }

    @keyframes labukzabuk {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    .container {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      justify-content: center;
      padding: 1rem;
    }

    .card {
      background-color: white;
      color: #000;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      padding: 1rem;
      width: 18rem;
      transition: transform 0.2s ease-in-out, background-color 0.3s ease;
    }

    .card.focused {
      background-color: #e0f2fe;
      box-shadow: 0 0 20px #000000;
      transform: scale(1.1);
    }

    .card.unchecked.touched {
      background-color: #ea3b06 !important;
      color: white !important;
    }

    #actions {
      text-align: center;
      margin: 1rem;
    }

    #actions button {
      margin: 0.3rem;
      padding: 0.5rem 1rem;
      font-weight: bold;
      background-color: #4f46e5;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .summary {
      margin-top: 1rem;
      font-size: 1.1rem;
      color: #111827;
    }

    #note {
      color: gold;
      font-size: 18px;
    }

    .output {
      background-color: #fff;
      padding: 1rem;
      margin: 1rem auto;
      width: 90%;
      max-width: 600px;
      border-radius: 8px;
      text-align: center;
      font-size: 1.1rem;
      color: #dc2626;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>

<div class="header">
  <h1>üéì Student Attendance</h1>
  <button onclick="show1()">3A</button>
  <button onclick="show2()">3B</button>
  <button onclick="mark(true)">Mark All Present</button>
  <button onclick="reset()">Mark All Absent</button>
  <button onclick="toggleSpeech()" id="speechToggle">üîä Speech: ON</button>
  <button onclick="speedup()">speed +</button>
  <button onclick="speeddown()">speed -</button>
  <button id="speedshow"></button>

  <div id="d1" style="display: none;">
    <button onclick="generate_1()">Load Students (101 - 200)</button>
    <button onclick="generate_2()">Load Students (201 - 280)</button>
  </div>
  <div id="d2" style="display: none;">
    <button onclick="generate_3()">Load Students (301 - 429)</button>
  </div>
  <div id="note">
    <h6>=> Names are as per DU Student List 2025-26 Class 3A</h6>
    <h6>=> Use ‚Üë ‚Üì ‚Üê ‚Üí keys to mark and move</h6>
  </div>
</div>

<div id="dis" style="display: none;">---</div>
<div id="list" class="container"></div>

<div id="actions" style="display: none;">
  <button onclick="submit()">Submit</button>
  <div class="summary">
    Present: <span id="present">0</span> |
    Absent: <span id="absent">0</span>
  </div>
</div>

<div id="output" class="output" style="display: none;"></div>


<script>
  const students = [
  { name: "Jiya Kyada", rollNo: 101, enrollmentNo: "24010101151" },
  { name: "Shah Dhvani Hitesh", rollNo: 102, enrollmentNo: "24010101257" },
  { name: "Saraya Mohit Haresh", rollNo: 103, enrollmentNo: "24010101251" },
  {
    name: "Zalavadiya Heet Siddharth",
    rollNo: 104,
    enrollmentNo: "24010101311",
  },
  { name: "Darshil Dobariya", rollNo: 105, enrollmentNo: "24010101065" },
  { name: "Nafisa Gandhi", rollNo: 106, enrollmentNo: "24010101076" },
  {
    name: "Vasani Yashvi Niteshbhai",
    rollNo: 107,
    enrollmentNo: "24010101299",
  },
  {
    name: "Delvadiya Manavkumar Kirtibhai",
    rollNo: 108,
    enrollmentNo: "24010101056",
  },
  { name: "Ashara Palak Gopalbhai", rollNo: 109, enrollmentNo: "24010101008" },
  {
    name: "Lunagariya Greshi Kamleshbhai",
    rollNo: 110,
    enrollmentNo: "24010101158",
  },
  {
    name: "Nanavati Shrushti Gargesh",
    rollNo: 111,
    enrollmentNo: "24010101187",
  },
  { name: "Ranpara Jay Manishbhai", rollNo: 112, enrollmentNo: "24010101238" },
  { name: "Disha Mehta", rollNo: 113, enrollmentNo: "24010101173" },
  {
    name: "Thummar Niraj Bhaveshbhai",
    rollNo: 114,
    enrollmentNo: "24010101282",
  },
  {
    name: "Kachhava Nakul Umeshbhai",
    rollNo: 115,
    enrollmentNo: "24010101116",
  },
  {
    name: "Kanabar Urva Darshanbhai",
    rollNo: 116,
    enrollmentNo: "24010101124",
  },
  { name: "Nakar Dhruvil Hitesh", rollNo: 117, enrollmentNo: "24010101186" },
  {
    name: "Poshiya Priyanshi Ajaybhai",
    rollNo: 118,
    enrollmentNo: "24010101223",
  },
  {
    name: "Baravalia Dharitri Manharbhai",
    rollNo: 119,
    enrollmentNo: "24010101013",
  },
  {
    name: "Muchhara Kashish Hiteshbhai",
    rollNo: 120,
    enrollmentNo: "24010101184",
  },
  {
    name: "Chauhan Aditya Sureshbhai",
    rollNo: 121,
    enrollmentNo: "24010101038",
  },
  { name: "Harsora Sakshi Ajaybhai", rollNo: 122, enrollmentNo: "24010101097" },
  {
    name: "Katrodiya Sahil Rajeshbhai",
    rollNo: 123,
    enrollmentNo: "24010101139",
  },
  {
    name: "Trambadiya Parikshit Parimalbhai",
    rollNo: 124,
    enrollmentNo: "24010101284",
  },
  {
    name: "Padariya Preya Parasbhai",
    rollNo: 125,
    enrollmentNo: "24010101192",
  },
  {
    name: "Gambhava Krushiben Manojbhai",
    rollNo: 126,
    enrollmentNo: "24010101074",
  },
  {
    name: "Jadeja Vishwrajsinh Krushnasinh",
    rollNo: 127,
    enrollmentNo: "24010101107",
  },
  { name: "Patel Jiya Sandipbhai", rollNo: 128, enrollmentNo: "24010101214" },
  {
    name: "Pipalava Smit Ashvinbhai",
    rollNo: 129,
    enrollmentNo: "24010101219",
  },
  {
    name: "Gohil Harshrajsinh Jitendrasinh",
    rollNo: 130,
    enrollmentNo: "24010101091",
  },
  {
    name: "Kathiriya Arshi Keshubhai",
    rollNo: 131,
    enrollmentNo: "24010101138",
  },
  { name: "Undhad Vishwa Rajesh", rollNo: 132, enrollmentNo: "24010101288" },
  { name: "Diya Raiyani", rollNo: 133, enrollmentNo: "24010101229" },
  { name: "Chavda Maulik Vinodbhai", rollNo: 134, enrollmentNo: "24010101043" },
  {
    name: "Chavda Priyanka Prabodhbhai",
    rollNo: 135,
    enrollmentNo: "24010101044",
  },
  {
    name: "Chavda Virendrasinh Ashwinbhai",
    rollNo: 136,
    enrollmentNo: "24010101045",
  },
  {
    name: "Galani Krunal Chetanbhai",
    rollNo: 137,
    enrollmentNo: "24010101072",
  },
  { name: "Kavar Suchi Vasantbhai", rollNo: 138, enrollmentNo: "24010101140" },
  { name: "Odedara Nilesh Parbat", rollNo: 139, enrollmentNo: "24010101190" },
  {
    name: "Vasani Dishita Nikhilkumar",
    rollNo: 140,
    enrollmentNo: "24010101298",
  },
  {
    name: "Vachhani Vaishvi Manojkumar",
    rollNo: 141,
    enrollmentNo: "24010101290",
  },
  {
    name: "Bhadania Ronit Yatinbhai",
    rollNo: 142,
    enrollmentNo: "24010101017",
  },
  { name: "Chauhan Jenil Virenbhai", rollNo: 143, enrollmentNo: "24010101039" },
  {
    name: "Virpara Krisha Rajeshbhai",
    rollNo: 144,
    enrollmentNo: "24010101302",
  },
  {
    name: "Chandra Darshit Hiteshbhai",
    rollNo: 145,
    enrollmentNo: "24010101035",
  },
  {
    name: "Detroja Ruchit Arvindbhai",
    rollNo: 146,
    enrollmentNo: "24010101057",
  },
  {
    name: "Kapuriya Hepin Pravinbhai",
    rollNo: 147,
    enrollmentNo: "24010101131",
  },
  { name: "Gohel Smit Ashvinbhai", rollNo: 148, enrollmentNo: "24010101090" },
  { name: "Patel Kirtan Amitbhai", rollNo: 149, enrollmentNo: "24010101215" },
  { name: "Ginoya Deep Kantilal", rollNo: 150, enrollmentNo: "24010101085" },
  {
    name: "Marvaniya Jainish Dharmendrabhai",
    rollNo: 151,
    enrollmentNo: "24010101169",
  },
  { name: "Ajudiya Yash Nareshbhai", rollNo: 152, enrollmentNo: "24010101004" },
  { name: "Manas Borisagar", rollNo: 153, enrollmentNo: "24010101031" },
  { name: "Joshi Soham Kamleshbhai", rollNo: 154, enrollmentNo: "24010101113" },
  {
    name: "Kakadiya Khilan Manishbhai",
    rollNo: 155,
    enrollmentNo: "24010101117",
  },
  {
    name: "Sidhdhapura Dhaval Dharmeshbhai",
    rollNo: 156,
    enrollmentNo: "24010101265",
  },
  {
    name: "Sitapara Aryan Sunilbhai",
    rollNo: 157,
    enrollmentNo: "24010101267",
  },
  {
    name: "Bhatasana Nainshi Pareshbhai",
    rollNo: 158,
    enrollmentNo: "24010101021",
  },
  {
    name: "Malvaniya Viraj Jatinbhai",
    rollNo: 159,
    enrollmentNo: "24010101163",
  },
  { name: "Tanisha Pambhar", rollNo: 160, enrollmentNo: "24010101197" },
  {
    name: "Padshala Kuldeep Rajendrakumar",
    rollNo: 161,
    enrollmentNo: "24010101196",
  },
  {
    name: "Bhimani Vishva Manishbhai",
    rollNo: 162,
    enrollmentNo: "24010101026",
  },
  { name: "Karan Anushka Pintubhai", rollNo: 163, enrollmentNo: "24010101132" },
  { name: "Vyas Kavya Sachin", rollNo: 164, enrollmentNo: "24010101307" },
  { name: "Kamani Purna Hareshbhai", rollNo: 165, enrollmentNo: "24010101123" },
  {
    name: "Mori Nandita Renishkumar",
    rollNo: 166,
    enrollmentNo: "24010101183",
  },
  {
    name: "Ratanghayra Pankti Himanshu",
    rollNo: 167,
    enrollmentNo: "24010101239",
  },
  {
    name: "Rupala Nikhil Kashmeeraben",
    rollNo: 168,
    enrollmentNo: "24010101242",
  },
  {
    name: "Jadeja Shivrajsinh Girirajsinh",
    rollNo: 169,
    enrollmentNo: "24010101106",
  },
  { name: "Hirva Satani", rollNo: 170, enrollmentNo: "24010101252" },
  {
    name: "Raiyani Jenil Sanjaybhai",
    rollNo: 171,
    enrollmentNo: "24010101230",
  },
  {
    name: "Chandpa Prince Sureshbhai",
    rollNo: 172,
    enrollmentNo: "24010101034",
  },
  {
    name: "Faldu Vrajesh Sanjaybhai",
    rollNo: 173,
    enrollmentNo: "24010101069",
  },
  {
    name: "Khambholiya Manya Parasharbhai",
    rollNo: 174,
    enrollmentNo: "24010101142",
  },
  {
    name: "Prajapati Kaivalya Samir",
    rollNo: 175,
    enrollmentNo: "24010101224",
  },
  {
    name: "Moral Aadit Shaileshbhai",
    rollNo: 176,
    enrollmentNo: "24010101182",
  },
  {
    name: "Shihora Vibhu Chetanbhai",
    rollNo: 177,
    enrollmentNo: "24010101260",
  },
  { name: "Kanani Kruti Jayeshbhai", rollNo: 178, enrollmentNo: "24010101126" },
  {
    name: "Karoliya Princekumar Sandipbhai",
    rollNo: 179,
    enrollmentNo: "24010101135",
  },
  { name: "Khunt Rutvi Hiteshbhai", rollNo: 180, enrollmentNo: "24010101146" },
  {
    name: "Charadva Abhishek Virenbhai",
    rollNo: 181,
    enrollmentNo: "24010101036",
  },
  { name: "Dave Krisha Kalpeshbhai", rollNo: 182, enrollmentNo: "24010101053" },
  { name: "Janvi Kalaria", rollNo: 183, enrollmentNo: "24010101119" },
  { name: "Rajwani Rohan Malik", rollNo: 184, enrollmentNo: "24010101232" },
  {
    name: "Rana Parthrajsinh Bhupatsinh",
    rollNo: 185,
    enrollmentNo: "24010101235",
  },
  {
    name: "Solanki Ronak Arvindbhai",
    rollNo: 186,
    enrollmentNo: "24010101271",
  },
  {
    name: "Panchal Vedantkumar Niravbhai",
    rollNo: 187,
    enrollmentNo: "24010101198",
  },
  {
    name: "Ambasana Venisha Hitenbhai",
    rollNo: 188,
    enrollmentNo: "24010101006",
  },
  {
    name: "Raichura Smeet Rohitkumar",
    rollNo: 189,
    enrollmentNo: "24010101228",
  },
  {
    name: "Gambhava Mirali Sureshbhai",
    rollNo: 190,
    enrollmentNo: "24010101075",
  },
  { name: "Dave Dhruv Viralkumar", rollNo: 191, enrollmentNo: "24010101050" },
  { name: "Ghetiya Ritu Pankajbhai", rollNo: 192, enrollmentNo: "24010101080" },
  {
    name: "Radhanpara Saumya Jatinbhai",
    rollNo: 193,
    enrollmentNo: "24010101226",
  },
  {
    name: "Yadav Gaurav Kaushikbhai",
    rollNo: 194,
    enrollmentNo: "24010101308",
  },
  {
    name: "Buddhadev Misri Sanjaybhai",
    rollNo: 195,
    enrollmentNo: "24010101033",
  },
  { name: "Joshi Kairav Paren", rollNo: 196, enrollmentNo: "24010101112" },
  {
    name: "Savaliya Dhruvi Bharatbhai",
    rollNo: 197,
    enrollmentNo: "24010101253",
  },
  { name: "Radhanpura Jeel Nimish", rollNo: 198, enrollmentNo: "24010101227" },
  {
    name: "Savaliya Priyanshi Sureshbhai",
    rollNo: 199,
    enrollmentNo: "24010101255",
  },
  {
    name: "Zala Bhavyadeepsinh Pruthvirajsinh",
    rollNo: 200,
    enrollmentNo: "24010101310",
  },
  {
    name: "Sinha Milankumar Sujitkumar",
    rollNo: 201,
    enrollmentNo: "24010101266",
  },
  { name: "Lakhtaria Kevin Homin", rollNo: 202, enrollmentNo: "24010101153" },
  {
    name: "Moliya Kartavya Bhaveshbhai",
    rollNo: 203,
    enrollmentNo: "24010101180",
  },
  { name: "Monpara Nij Hareshbhai", rollNo: 204, enrollmentNo: "24010101181" },
  { name: "Divya Thakar", rollNo: 205, enrollmentNo: "24010101280" },
  {
    name: "Mendapara Piyu Amishbhai",
    rollNo: 206,
    enrollmentNo: "24010101177",
  },
  { name: "Pandya Karan Tusharbhai", rollNo: 207, enrollmentNo: "24010101199" },
  { name: "Raval Meet Mohitkumar", rollNo: 208, enrollmentNo: "24010101241" },
  {
    name: "Virpariya Heer Manishbhai",
    rollNo: 209,
    enrollmentNo: "24010101303",
  },
  { name: "Bhanushali Hiral Bhaven", rollNo: 210, enrollmentNo: "24010101020" },
  {
    name: "Kamaliya Akashkumar Rameshbhai",
    rollNo: 211,
    enrollmentNo: "24010101121",
  },
  { name: "Popat Honey Nileshbhai", rollNo: 212, enrollmentNo: "24010101222" },
  {
    name: "Badrakiya Meet Bharatbhai",
    rollNo: 213,
    enrollmentNo: "24010101009",
  },
  { name: "Kanani Kavit Nareshbhai", rollNo: 214, enrollmentNo: "24010101125" },
  {
    name: "Ambaliya Manan Jayeshbhai",
    rollNo: 215,
    enrollmentNo: "24010101005",
  },
  { name: "Hinsu Umang Bharatbhai", rollNo: 216, enrollmentNo: "24010101099" },
  {
    name: "Kakaniya Bhavy Niteshbhai",
    rollNo: 217,
    enrollmentNo: "24010101118",
  },
  { name: "Padia Kartik Balkrishna", rollNo: 218, enrollmentNo: "24010101195" },
  {
    name: "Mankada Hasan Shabbirhusain",
    rollNo: 219,
    enrollmentNo: "24010101166",
  },
  {
    name: "Mehta Dhairy Kalpeshbhai",
    rollNo: 220,
    enrollmentNo: "24010101172",
  },
  { name: "Mehta Het Lalitkumar", rollNo: 221, enrollmentNo: "24010101174" },
  { name: "Kahan Sanghani", rollNo: 222, enrollmentNo: "24010101246" },
  {
    name: "Gotani Himesh Sanjaybhai",
    rollNo: 223,
    enrollmentNo: "24010101095",
  },
  { name: "Narola Yash Nileshbhai", rollNo: 224, enrollmentNo: "24010101189" },
  {
    name: "Targata Dharmishtha Arjanbhai",
    rollNo: 225,
    enrollmentNo: "24010101279",
  },
  {
    name: "Bhuva Tirth Shaileshbhai",
    rollNo: 226,
    enrollmentNo: "24010101030",
  },
  {
    name: "Jadeja Yashraj Lakhdhirsinh",
    rollNo: 227,
    enrollmentNo: "24010101108",
  },
  { name: "Krisha Pujara", rollNo: 228, enrollmentNo: "24010101225" },
  { name: "Varsani Ritul Hirji", rollNo: 229, enrollmentNo: "24010101296" },
  { name: "Parmar Dhyey Dharmendra", rollNo: 230, enrollmentNo: "24010101208" },
  {
    name: "Shingala Mansi Rajeshbhai",
    rollNo: 231,
    enrollmentNo: "24010101263",
  },
  {
    name: "Dobariya Jeel Upendrabhai",
    rollNo: 232,
    enrollmentNo: "24010101066",
  },
  {
    name: "Khant Mannkumar Jigneshbhai",
    rollNo: 233,
    enrollmentNo: "24010101143",
  },
  { name: "Yadav Neel Hiteshbhai", rollNo: 234, enrollmentNo: "24010101309" },
  {
    name: "Andodariya Yash Maheshbhai",
    rollNo: 235,
    enrollmentNo: "24010101007",
  },
  {
    name: "Hirani Jeelkumar Sanjaybhai",
    rollNo: 236,
    enrollmentNo: "24010101101",
  },
  {
    name: "Mankad Shyamsundar Mitbhai",
    rollNo: 237,
    enrollmentNo: "24010101165",
  },
  { name: "Agavan Rohan Farukbhai", rollNo: 238, enrollmentNo: "24010101001" },
  { name: "Bhadja Zeel Satishkumar", rollNo: 239, enrollmentNo: "24010101018" },
  {
    name: "Shreya Vijaybhai Bhundia",
    rollNo: 240,
    enrollmentNo: "24010101028",
  },
  { name: "Aghara Keyur Hiteshbhai", rollNo: 241, enrollmentNo: "24010101002" },
  {
    name: "Buddhadev Deep Nitinbhai",
    rollNo: 242,
    enrollmentNo: "24010101032",
  },
  { name: "Godham Meet Maheshbhai", rollNo: 243, enrollmentNo: "24010101086" },
  {
    name: "Katariya Trisha Ashvinbhai",
    rollNo: 244,
    enrollmentNo: "24010101137",
  },
  { name: "Vekariya Jay Bipinbhai", rollNo: 245, enrollmentNo: "24010101301" },
  { name: "Rutvi Gautami", rollNo: 246, enrollmentNo: "24010101077" },
  {
    name: "Sankaliya Aryan Ashokbhai",
    rollNo: 247,
    enrollmentNo: "24010101247",
  },
  {
    name: "Ghadiya Yashvi Sanjaybhai",
    rollNo: 248,
    enrollmentNo: "24010101078",
  },
  { name: "Ved Chatvani", rollNo: 249, enrollmentNo: "24010101037" },
  { name: "Ghorai Swati Sanjib", rollNo: 250, enrollmentNo: "24010101084" },
  {
    name: "Karena Radhika Bharatbhai",
    rollNo: 251,
    enrollmentNo: "24010101134",
  },
  { name: "Pandya Kruti Tusharbhai", rollNo: 252, enrollmentNo: "24010101200" },
  {
    name: "Patel Tejkumar Niteshbhai",
    rollNo: 253,
    enrollmentNo: "24010101218",
  },
  {
    name: "Sagpariya Mahee Nitinbhai",
    rollNo: 254,
    enrollmentNo: "24010101244",
  },
  {
    name: "Sherasiya Shyam Sureshbhai",
    rollNo: 255,
    enrollmentNo: "24010101258",
  },
  { name: "Liya Hirvita Rajendra", rollNo: 256, enrollmentNo: "24010101157" },
  { name: "Ahir Krishna Manishbhai", rollNo: 257, enrollmentNo: "24010101003" },
  {
    name: "Parmar Devanshu Gopalbhai",
    rollNo: 258,
    enrollmentNo: "24010101206",
  },
  { name: "Tivari Astha Sureshbhai", rollNo: 259, enrollmentNo: "24010101283" },
  { name: "Pal Kana Odedra", rollNo: 260, enrollmentNo: "24010101191" },
  {
    name: "Sorathiya Nabhag Sanjaybhai",
    rollNo: 261,
    enrollmentNo: "24010101275",
  },
  {
    name: "Chauhan Vishal Girishbhai",
    rollNo: 262,
    enrollmentNo: "24010101042",
  },
  { name: "Kuchhadiya Vanita Bhima", rollNo: 263, enrollmentNo: "24010101150" },
  {
    name: "Bhimani Naman Chiragbhai",
    rollNo: 264,
    enrollmentNo: "24010101025",
  },
  {
    name: "Diyora Miraj Bhaveshbhai",
    rollNo: 265,
    enrollmentNo: "24010101064",
  },
  {
    name: "Gajera Rakshit Ketanbhai",
    rollNo: 266,
    enrollmentNo: "24010101071",
  },
  { name: "Parmar Darpan Jitendra", rollNo: 267, enrollmentNo: "24010101205" },
  {
    name: "Trivedi Manan Vijaykumar",
    rollNo: 268,
    enrollmentNo: "24010101285",
  },
  {
    name: "Dave Maharshi Kirtikumar",
    rollNo: 269,
    enrollmentNo: "24010101055",
  },
  {
    name: "Param Rameshbhai Kotadiya",
    rollNo: 270,
    enrollmentNo: "24010101148",
  },
  { name: "Patel Archi Pradipbhai", rollNo: 271, enrollmentNo: "24010101213" },
  {
    name: "Saradhara Yug Vrajbhushanbhai",
    rollNo: 272,
    enrollmentNo: "24010101250",
  },
  {
    name: "Padhariya Ruturajsinh Sureshbhai",
    rollNo: 273,
    enrollmentNo: "24010101193",
  },
  { name: "Vegad Jenil Ashokbhai", rollNo: 274, enrollmentNo: "24010101300" },
  {
    name: "Patani Kismatbanu Shahidbhai",
    rollNo: 275,
    enrollmentNo: "24010101212",
  },
  {
    name: "Savaliya Jinesh Kantilal",
    rollNo: 276,
    enrollmentNo: "24010101254",
  },
  { name: "Tank Darshan Chetanbhai", rollNo: 277, enrollmentNo: "24010101277" },
  { name: "Ghodasara Dev Ketanbhai", rollNo: 278, enrollmentNo: "24010101081" },
  {
    name: "Pithadiya Yash Devendrabhai",
    rollNo: 279,
    enrollmentNo: "24010101221",
  },
  { name: "Gohel Jenil Amitkumar", rollNo: 280, enrollmentNo: "24010101088" },
];
const students1 = [
  { name: "Javiya Nirali Ramjibhai", rollNo: 301, enrollmentNo: "24010101110" },
  { name: "Kothadia Jal Hiteshkumar", rollNo: 302, enrollmentNo: "24010101149" },
  { name: "Parmar Bhavik Arjanbhai", rollNo: 303, enrollmentNo: "24010101204" },
  { name: "Ramani Manav Satishbhai", rollNo: 304, enrollmentNo: "24010101234" },
  { name: "Rathod Paras Ravibhai", rollNo: 305, enrollmentNo: "24010101240" },
  { name: "Chauhan Smit Hasmukhbhai", rollNo: 306, enrollmentNo: "24010101041" },
  { name: "Lunagariya Tirth Jayeshbhai", rollNo: 307, enrollmentNo: "24010101159" },
  { name: "Bhatti Jiya Pankajbhai", rollNo: 308, enrollmentNo: "24010101023" },
  { name: "Dhaduk Vandan Dipakbhai", rollNo: 309, enrollmentNo: "24010101060" },
  { name: "Khorajiya Mahir Mustufa", rollNo: 310, enrollmentNo: "24010101145" },
  { name: "Dangar Naimish Hasmukhbhai", rollNo: 311, enrollmentNo: "24010101049" },
  { name: "Sureja Vrunda Sumitbhai", rollNo: 312, enrollmentNo: "24010101276" },
  { name: "Manek Malay Rishibhai", rollNo: 313, enrollmentNo: "24010101164" },
  { name: "Raiyani Vishva Nileshbhai", rollNo: 314, enrollmentNo: "24010101231" },
  { name: "Santoki Sakshiben Devendrabhai", rollNo: 315, enrollmentNo: "24010101249" },
  { name: "Solanki Naimisha Ganeshbhai", rollNo: 316, enrollmentNo: "24010101270" },
  { name: "Taraviya Krutagn Dilipkumar", rollNo: 317, enrollmentNo: "24010101278" },
  { name: "Bhatti Hardvi Rajendrabhai", rollNo: 318, enrollmentNo: "24010101022" },
  { name: "Dobariya Rutvi Rasikbhai", rollNo: 319, enrollmentNo: "24010101067" },
  { name: "Gohel Darshan Kishorbhai", rollNo: 320, enrollmentNo: "24010101087" },
  { name: "Siddhpura Vrinda Nileshbhai", rollNo: 321, enrollmentNo: "24010101264" },
  { name: "Somaiya Nihal Dipak", rollNo: 322, enrollmentNo: "24010101273" },
  { name: "Vala Harsiddhiba Jayvirsinh", rollNo: 323, enrollmentNo: "24010101293" },
  { name: "Rankja Khushi Satishbhai", rollNo: 324, enrollmentNo: "24010101237" },
  { name: "Shingala Jina Dilipbhai", rollNo: 325, enrollmentNo: "24010101262" },
  { name: "Shingala Dharmik Dharmeshbhai", rollNo: 326, enrollmentNo: "24010101261" },
  { name: "Parsana Shubham Pareshbhai", rollNo: 327, enrollmentNo: "24010101210" },
  { name: "Mendpara Krishaben Hasmukhbhai", rollNo: 328, enrollmentNo: "24010101179" },
  { name: "Barevadiya Devarsh Harikrushnabhai", rollNo: 329, enrollmentNo: "24010101014" },
  { name: "Gopani Mitsu Bharatbhai", rollNo: 330, enrollmentNo: "24010101093" },
  { name: "Jamod Kashika Pravinbhai", rollNo: 331, enrollmentNo: "24010101109" },
  { name: "Kalola Hill Kishorbhai", rollNo: 332, enrollmentNo: "24010101120" },
  { name: "Pipaliya Meet Bharatbhai", rollNo: 333, enrollmentNo: "24010101220" },
  { name: "Sadhu Kuldeep Harshadkumar", rollNo: 334, enrollmentNo: "24010101243" },
  { name: "Dhandha Aayushi Sanatbhai", rollNo: 335, enrollmentNo: "24010101063" },
  { name: "Jadeja Riddhiba Jayendrasinh", rollNo: 336, enrollmentNo: "24010101105" },
  { name: "Kanjariya Radhika Mukeshbhai", rollNo: 337, enrollmentNo: "24010101128" },
  { name: "Joshi Vivek Bhaveshbhai", rollNo: 338, enrollmentNo: "24010101114" },
  { name: "Dashadiya Yash Kishorbhai", rollNo: 339, enrollmentNo: "24010101312" },
  { name: "Kanzariya Krunal Pravinbhai", rollNo: 340, enrollmentNo: "24010101130" },
  { name: "Jodhani Dhruvbhai Rajeshkumar", rollNo: 341, enrollmentNo: "24010101111" },
  { name: "Shivang Nandani", rollNo: 342, enrollmentNo: "24010101188" },
  { name: "Rangani Arpit Dilipbhai", rollNo: 343, enrollmentNo: "24010101236" },
  { name: "Ghodasara Yashvi Dhirajlal", rollNo: 344, enrollmentNo: "24010101082" },
  { name: "Rakhasiya Nikhil Hasmukhbhai", rollNo: 345, enrollmentNo: "24010101233" },
  { name: "Dhamsaniya Princyben Ashokbhai", rollNo: 346, enrollmentNo: "24010101062" },
  { name: "Tirth Gamara", rollNo: 347, enrollmentNo: "24010101073" },
  { name: "Mahek Patel", rollNo: 348, enrollmentNo: "24010101216" },
  { name: "Kasundra Prakruti Sanjaybhai", rollNo: 349, enrollmentNo: "24010101136" },
  { name: "Kacha Param Sanjay", rollNo: 350, enrollmentNo: "24010101115" },
  { name: "Sorathiya Mann Ashvinbhai", rollNo: 351, enrollmentNo: "24010101274" },
  { name: "Vansajaliya Ankit Hemantbhai", rollNo: 352, enrollmentNo: "24010101295" },
  { name: "Fultariya om", rollNo: 353, enrollmentNo: "24010101070" },
  { name: "Manvar Hemil Rakeshbhai", rollNo: 354, enrollmentNo: "24010101167" },
  { name: "Detroja Ujjwal Narendrabhai", rollNo: 355, enrollmentNo: "24010101059" },
  { name: "Hinsu Vraj Devjibhai", rollNo: 356, enrollmentNo: "24010101100" },
  { name: "Vala Prashantkumar Maheshbhai", rollNo: 357, enrollmentNo: "24010101294" },
  { name: "Jadeja Manvendrasinh Jaydeepsinh", rollNo: 358, enrollmentNo: "24010101104" },
  { name: "Meghani Rishita Narendrabhai", rollNo: 359, enrollmentNo: "24010101171" },
  { name: "Hirani Tulsiben Rohitbhai", rollNo: 360, enrollmentNo: "24010101102" },
  { name: "Makwana Shraddha Shaileshbhai", rollNo: 361, enrollmentNo: "24010101161" },
  { name: "Bhalala Het Lalitbhai", rollNo: 362, enrollmentNo: "24010101019" },
  { name: "Chotaliya Jenish Ashokbhai", rollNo: 363, enrollmentNo: "24010101047" },
  { name: "Detroja Sharadkumar Dilipbhai", rollNo: 364, enrollmentNo: "24010101058" },
  { name: "Kardani Prince Vipulbhai", rollNo: 365, enrollmentNo: "24010101133" },
  { name: "Ughreja Dax Ashokbhai", rollNo: 366, enrollmentNo: "24010101286" },
  { name: "Khambhala Tarkesh Vallabhbhai", rollNo: 367, enrollmentNo: "24010101141" },
  { name: "Sodha Kashwiniba Lakhansinh", rollNo: 368, enrollmentNo: "24010101268" },
  { name: "Vachhani Janvi Avinashbhai", rollNo: 369, enrollmentNo: "24010101289" },
  { name: "Dave Hetvi Gopalbhai", rollNo: 370, enrollmentNo: "24010101052" },
  { name: "Padia Harsh Jitendrabhai", rollNo: 371, enrollmentNo: "24010101194" },
  { name: "Umretiya Kush Bharatbhai", rollNo: 372, enrollmentNo: "24010101287" },
  { name: "Khokhar Dhruvi Govind", rollNo: 373, enrollmentNo: "24010101144" },
  { name: "Parmar Anirudhdha Govindbhai", rollNo: 374, enrollmentNo: "24010101203" },
  { name: "Bhimani Jeel Yogeshbhai", rollNo: 375, enrollmentNo: "24010101024" },
  { name: "Patel Neel Sanjaykumar", rollNo: 376, enrollmentNo: "24010101217" },
  { name: "Mehta Sneha Ashvinbhai", rollNo: 377, enrollmentNo: "24010101175" },
  { name: "Parekh Bhargav Sanjaybhai", rollNo: 378, enrollmentNo: "24010101202" },
  { name: "Sakariya Mihir Kishorbhai", rollNo: 379, enrollmentNo: "24010101245" },
  { name: "Gondaliya Shrijal Jayeshkumar", rollNo: 380, enrollmentNo: "24010101092" },
  { name: "Makvana Rutvik Kalpeshbhai", rollNo: 381, enrollmentNo: "24010101160" },
  { name: "Dodiya Riya Darshanbhai", rollNo: 382, enrollmentNo: "24010101068" },
  { name: "Limbasiya Deep Pareshbhai", rollNo: 383, enrollmentNo: "24010101156" },
  { name: "Parmar Dhruvi Nareshbhai", rollNo: 384, enrollmentNo: "24010101207" },
  { name: "Vishva Thesiya", rollNo: 385, enrollmentNo: "24010101281" },
  { name: "Dave Dhruv Yogeshkumar", rollNo: 386, enrollmentNo: "24010101051" },
  { name: "Lakkad Devisbhai Arvindbhai", rollNo: 387, enrollmentNo: "24010101154" },
  { name: "Dalsaniya Yashvi Jayeshkumar", rollNo: 388, enrollmentNo: "24010101048" },
  { name: "Bhuva Shivam Ashwinbhai", rollNo: 389, enrollmentNo: "24010101029" },
  { name: "Malaviya Mitul Mukeshbhai", rollNo: 390, enrollmentNo: "24010101162" },
  { name: "Solanki Aryan Valjibhai", rollNo: 391, enrollmentNo: "24010101269" },
  { name: "Vora Rudra Girishbhai", rollNo: 392, enrollmentNo: "24010101305" },
  { name: "Solanki Vishal Rameshbhai", rollNo: 393, enrollmentNo: "24010101272" },
  { name: "Vyas Jinal Amitbhai", rollNo: 394, enrollmentNo: "24010101306" },
  { name: "Savaliya Tirth Navnitbhai", rollNo: 395, enrollmentNo: "24010101256" },
  { name: "Vasani Daksh Nikhilkumar", rollNo: 396, enrollmentNo: "24010101297" },
  { name: "Kantesaria Pari Romalbhai", rollNo: 397, enrollmentNo: "24010101129" },
  { name: "Baraiya Yash Nileshbhai", rollNo: 398, enrollmentNo: "24010101012" },
  { name: "Goswami Rudra Nileshgar", rollNo: 399, enrollmentNo: "24010101094" },
  { name: "Ladani Mann Snehalbhai", rollNo: 400, enrollmentNo: "24010101152" },
   { name: "Parmar Uday Jagdishbhai", rollNo: 401, enrollmentNo: "24010101209" },
  { name: "Parsaniya Dhruvkumar Jayendrabhai", rollNo: 402, enrollmentNo: "24010101211" },
  { name: "Vagh Dhavalbhai Nareshbhai", rollNo: 403, enrollmentNo: "24010101291" },
  { name: "Ghoniya Vrunda Dilipbhai", rollNo: 404, enrollmentNo: "24010101083" },
  { name: "Sankhavara Prayag Mansukhlal", rollNo: 405, enrollmentNo: "24010101248" },
  { name: "Gohel Kuldeep Kishorbhai", rollNo: 406, enrollmentNo: "24010101089" },
  { name: "Bhoraniya Priya Sureshbhai", rollNo: 407, enrollmentNo: "24010101027" },
  { name: "Bajadiya Om Bhupatbhai", rollNo: 408, enrollmentNo: "24010101011" },
  { name: "Ghardeshiya Man Ashokbhai", rollNo: 409, enrollmentNo: "24010101079" },
  { name: "Harkhani Ronak Prafulbhai", rollNo: 410, enrollmentNo: "24010101096" },
  { name: "Aryansinh Lalakia", rollNo: 411, enrollmentNo: "24010101155" },
  { name: "Mendapara Utpal Shaileshbhai", rollNo: 412, enrollmentNo: "24010101178" },
  { name: "Bechra Diya Jayesh", rollNo: 413, enrollmentNo: "24010101016" },
  { name: "Mathakiya Navfal Kutbudin", rollNo: 414, enrollmentNo: "24010101170" },
  { name: "Kamaliya Manaliben Dineshbhai", rollNo: 415, enrollmentNo: "24010101122" },
  { name: "Vaghera Vaidika Hinaben", rollNo: 416, enrollmentNo: "24010101292" },
  { name: "Dave Krisha Satyakam", rollNo: 417, enrollmentNo: "24010101054" },
  { name: "Markana Nisarg Maheshbhai", rollNo: 418, enrollmentNo: "24010101168" },
  { name: "Bagda Sandipkumar Danabhai", rollNo: 419, enrollmentNo: "24010101010" },
  { name: "Vora Preet Chetankumar", rollNo: 420, enrollmentNo: "24010101304" },
  { name: "Dhamsaniya Dhvani Kishorbhai", rollNo: 421, enrollmentNo: "24010101061" },
  { name: "Mungara Meet Vithalbhai", rollNo: 422, enrollmentNo: "24010101185" },
  { name: "Hinsu Maitri Dipakbhai", rollNo: 423, enrollmentNo: "24010101098" },
  { name: "Mehta Vatsal Yogeshkumar", rollNo: 424, enrollmentNo: "24010101176" },
  { name: "Chadamiya Bhavy Babulal", rollNo: 425, enrollmentNo: "24010101902" },
  { name: "Bavaliya Tushar Pravinbhai", rollNo: 426, enrollmentNo: "24010101015" },
  { name: "Kotadia Richa Cheritkumar", rollNo: 427, enrollmentNo: "24010101147" },
  { name: "Chauhan Krutarth Rajubhai", rollNo: 428, enrollmentNo: "24010101040" },
  { name: "Sheth Harsh Ketanbhai", rollNo: 429, enrollmentNo: "24010101259" }
];


  let dis = document.getElementById("dis");
  let focusedIndex = 0;
  let rollNos = [];
  let data = [];
  let speechEnabled = true;
  let rate = 1;
  let speeddisplay = document.getElementById("speedshow");

  speeddisplay.innerHTML = "speed = " + rate;

  function show1() {
    dis.innerHTML = "---";
    document.getElementById("list").innerHTML = "";
    document.getElementById("d1").style.display = "block";
    document.getElementById("d2").style.display = "none";
    document.getElementById("note").style.display = "none";
    speaksbtn("3a");
  }

  function show2() {
    dis.innerHTML = "---";
    document.getElementById("list").innerHTML = "";
    document.getElementById("d2").style.display = "block";
    document.getElementById("d1").style.display = "none";
    document.getElementById("note").style.display = "none";
    speaksbtn("3b");
  }// on click on card it focus on that card
  function focusCheckbox(cardDiv) {
  const checkbox = cardDiv.querySelector("input[type='checkbox']");
  if (checkbox) {
    checkbox.focus();  
  }
}

//highlight card 
let lastSpokenId = null;

function highlightCard(checkbox) {
  const card = checkbox.closest('.card');
  card.classList.add("focused", "touched");

  const id = checkbox.id;
  const num = parseInt(id.substring(1));
  focusedIndex = rollNos.indexOf(num);

  const student = data[num];
  if (student) {
    const isChecked = checkbox.checked;
    dis.innerHTML = `
      <div>
        <h1><strong>Roll-No:</strong> ${student.rollNo}</h1>
        <strong>Enroll:</strong> ${student.enrollmentNo}<br>
        <strong>Name:</strong> ${student.name}<br>
        <span style="display:inline-block; margin-top: 5px; padding: 4px 10px; border-radius: 10px; font-weight: bold;
          background-color: ${isChecked ? '#22c55e' : '#dc2626'};
          color: white;">
          ${isChecked ? 'Present' : 'Absent'}
        </span>
      </div>`;

    // Speak only if newly focused
    if (lastSpokenId !== id) {
      speak(`${student.rollNo}`);
      lastSpokenId = id;
    }
  } else {
    dis.innerHTML = "---";
  }
}


  function unhighlightCard(checkbox) {
    const card = checkbox.closest('.card');
    card.classList.remove("focused");

    if (!card.classList.contains("touched")) {
      card.classList.add("touched", "unchecked");
      card.classList.remove("checked");
    }

    update();
  }

  function speak(text) {
    if (!speechEnabled) return;
    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = 'en-IN';
    utter.pitch = 1;
    utter.rate = rate;
    window.speechSynthesis.cancel();
    window.speechSynthesis.speak(utter);
  }

  function speaksbtn(text, callback = null) {
    if (!speechEnabled) return callback?.();
    const utter = new SpeechSynthesisUtterance(text);
    utter.lang = 'en-IN';
    utter.pitch = 2;
    utter.rate = 2;
    window.speechSynthesis.cancel();
    if (callback) utter.onend = callback;
    window.speechSynthesis.speak(utter);
  }

  function toggleSpeech() {
    speechEnabled = !speechEnabled;
    document.getElementById("speechToggle").textContent = speechEnabled ? "üîä Speech: ON" : "üîá Speech: OFF";
  }

  function speedup() {
    if (rate < 8) rate++;
    speaksbtn("speed up");
    speeddisplay.innerHTML = "speed = " + rate;
  }

  function speeddown() {
    if (rate > 1) rate--;
    speaksbtn("speed down");
    speeddisplay.innerHTML = "speed = " + rate;
  }

  document.addEventListener("keydown", (e) => {
    if (rollNos.length === 0) return;
    const currentId = "r" + rollNos[focusedIndex];
    const currentCheckbox = document.getElementById(currentId);
    if (!currentCheckbox) return;

    switch (e.key) {
      case "ArrowRight":
        e.preventDefault();
        if (focusedIndex < rollNos.length - 1) {
          focusedIndex++;
          document.getElementById("r" + rollNos[focusedIndex]).focus();
        }
        break;
      case "ArrowLeft":
        e.preventDefault();
        if (focusedIndex > 0) {
          focusedIndex--;
          document.getElementById("r" + rollNos[focusedIndex]).focus();
        }
        break;
      case "ArrowUp":
        e.preventDefault();
        currentCheckbox.checked = true;
        update();
        break;
      case "ArrowDown":
        e.preventDefault();
        currentCheckbox.checked = false;
        update();
        break;
    }
  });

  function generate_1() {
    speaksbtn("101 to 200", () => generateList(0, 99, students));
    dis.innerHTML="---";
  }

  function generate_2() {
    speaksbtn("201 to 280", () => generateList(100, 179, students));
     dis.innerHTML="---";
  }

  function generate_3() {
    speaksbtn("301 to 429", () => generateList(0, 128, students1));
     dis.innerHTML="---";
  }

  function generateList(start, end, source) {
    dis.style.display = "block";
    focusedIndex = 0;
    data = source;
    rollNos = [];
    const list = document.getElementById("list");
    list.innerHTML = "";
    document.getElementById("actions").style.display = "none";
    document.getElementById("output").style.display = "none";

    for (let i = start; i <= end; i++) {
      rollNos.push(i);
      setTimeout(() => {
        list.innerHTML += `<div class="card" onclick="focusCheckbox(this)">
          <div class="card-body">
            <h5 class="card-title">Roll No: ${source[i].rollNo}</h5>
            <h6 class="card-subtitle">Enrollment No: ${source[i].enrollmentNo}</h6>
            <p class="card-text">Student Name: ${source[i].name}</p>
            <input type="checkbox" id="r${i}" tabindex="0" onchange="update()" 
              onfocus="highlightCard(this)" onblur="unhighlightCard(this)">
          </div>
        </div>`;
      }, (i - start) * 30);
    }

    setTimeout(() => {
      document.getElementById("actions").style.display = "block";
      //autofocus on forst
      document.getElementById("r" + rollNos[0])?.focus();
      update();
    }, (end - start + 1) * 30 + 100);
  }

  function update() {
  let present = 0;

  rollNos.forEach((r) => {
    const checkbox = document.getElementById("r" + r);
    const card = checkbox?.closest(".card");

    if (!card?.classList.contains("touched")) return;

    if (checkbox.checked) {
      present++;
      card.classList.remove("unchecked");
      card.classList.add("checked");
    } else {
      card.classList.remove("checked");
      card.classList.add("unchecked");
    }
  });

  document.getElementById("present").textContent = present;
  document.getElementById("absent").textContent = rollNos.length - present;

  //  Refresh display label for currently focused checkbox
  if (rollNos[focusedIndex] !== undefined) {
    const checkbox = document.getElementById("r" + rollNos[focusedIndex]);
    if (checkbox && document.activeElement === checkbox) {
      highlightCard(checkbox); // update label
    }
  }
}

  function mark(state) {
    rollNos.forEach((r) => {
      const checkbox = document.getElementById("r" + r);
      if (checkbox) {
        checkbox.checked = state;
        checkbox.closest(".card").classList.add("touched");
      }
    });
    update();
    speaksbtn(state ? "Mark All Present" : "Mark All Absent");
  }

  function reset() {
    mark(false);
  }

  function submit() {
    speaksbtn("Submitted successfully");
    const absents = rollNos.filter(r => !document.getElementById("r" + r).checked);
    const output = document.getElementById("output");
    output.style.display = "block";
    output.textContent = absents.length === 0
      ? "üéâ All students are present!"
      : "Absent Roll Numbers:\n" + absents.map(i => data[i].rollNo).join(", ");
  }
</script>

</body>
</html>
